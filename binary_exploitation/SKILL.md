---
name: Binary Exploitation
description: Mastery of memory corruption exploitation (Stack, Heap, Kernel) and mitigation bypasses.
author: 1ikeadragon
license: GPLv3
---

# Binary Exploitation

## Skill Overview

**Prerequisites**: C, Assembly, OS Memory Management (Paging, Slab/Slub), Allocator Internals  
**Goal**: Turn memory corruption bugs (overflows, UAF) into arbitrary code execution or privilege escalation.

---

## Core Principles

### Primitive Mastery
Focus on primitives:
- **Arbitrary Read**: Leak addresses (ASLR/Canary).
- **Arbitrary Write**: Overwrite function pointers/GOT/Kernel structs.
- **Control Flow Hijack**: ROP/JOP/COP.

---

## Modern Heap Exploitation (Userland)

### Glibc Internals (ptmalloc)
- **Tcache Poisoning**: Overwrite `fd` to point to target (requires Safe-Linking bypass).
- **Unsorted Bin Leak**: Leak `main_arena` (libc base).
- **Large Bin Attack**: Arbitrary write via `fd_nextsize`/`bk_nextsize`.
- **Visuals**: Use `gdb_debugging` skill (Pwndbg) to visualize heap layout.

---

## Kernel Exploitation (Ring-0)

### Modern Techniques (v5.x - v6.x)
- **Dirty Cred**: Swap `cred` structures (UAF -> Privilege Escalation).
- **SLUBStick**: Cross-cache attack using timing side-channels to turn heap bugs into reliable read/write.
- **KROP**: Kernel ROP to bypass SMEP/SMAP.

---

## Workflow: From Crash to Shell

### 1. Crash Analysis
- Use `gdb_debugging` skill to analyze register state and instruction at crash.

### 2. Bypass Mitigations
- **ASLR**: Leak base address.
- **NX**: Build ROP chains.
- **Canary**: Leak or brute-force.

### 3. Payload Construction
- Use `pwntools` for exploit scripting.
- **Tcache Obfuscation**: `(pos >> 12) ^ ptr`.

---

## Tool Mastery

### Pwntools
- `ELF`, `ROP`, `fmtstr_payload`.

### ROPgadget
- Find gadgets: `pop rdi; ret`.

### vmlinux-to-elf
- Symbol recovery for kernel exploits.

---

## Case Studies
- **Dirty Pipe**: `splice` syscall abuse.
- **Sudo Baron Samedit**: Heap overflow.
- **Android Binder**: UAF in IPC.
